---
title: "601_HW1_HTML"
author: "SantoshCheruku"
date: "9/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(corrplot)
```

## Load datasets
```{r}
train <- read.csv("https://raw.githubusercontent.com/lincarrieli/DATA621/master/moneyball-training-data.csv")
train <- train[c(2:17)]
summary(train)

head(train, n=10)

```

## Exploratory Data Analysis


### Wins by Team
```{r}
plot(train$TEAM_BATTING_H, train$TARGET_WINS )
```

### Use covariates
```{r}
#cor(train)

cor_train <- cor(train,  use = "na.or.complete")
corrplot(cor_train)
```

### Observe normality of selected variables
```{r}
par(mfrow=c(2,2))
hist(train$TEAM_BATTING_H,
     main = "hits histogram", xlab = "hits (season)",
     breaks = 20)
hist(train$TEAM_BATTING_2B,
     main = "doubles histogram", xlab = "doubles (season)",
     breaks = 20)
hist(train$TEAM_BATTING_3B,
     main = "triples histogram", xlab = "triples (season)",
     breaks = 20)
hist(train$TEAM_BATTING_HR,
     main = "homeruns histogram", xlab = "homeruns (season)",
     breaks = 20)
par(mfrow=c(1,1))
```


### Addressing data quality issues

From the summary, we can observe that following variables have a high number of NA or missing values, and we need to address these before we can work on the models.

TEAM_BATTING_SO  - 102</br>
TEAM_BASERUN_SB  - 131</br>
TEAM_BASERUN_CS - 772</br>
TEAM_BATTING_HBP - 2085</br>
TEAM_PITCHING_SO - 102</br>
TEAM_FIELDING_DP - 286</br>

Before we apply any strategy to deal with missing data, we fit the model with the full data set for comparison purposes
```{r}
lm1 <- lm(formula = train$TARGET_WINS ~ ., data = train)
summary(lm1)
```

TEAM_BATTING_HBP has highest number of missing cases i.e., 2085 (almost 90%). Therefore, we can drop this variable from our dataset.
```{r}
# Removing TEAM_BATTING_HBP variable
 train <- subset(train, select = -c(10))

# Now let's measure how many complete observations do we have
sum(complete.cases(train)==TRUE)
sum(complete.cases(train)==FALSE)
```

Now we compare the model fit to the missing version of the data
```{r}
lm2 <- lm(formula = train$TARGET_WINS ~ ., data = train)
summary(lm2)
```
The second model appears to be a better fit with smaller standard errors and more variables became strong predictors.


We have about 1486 complete observations, which is close to 65%. Therefore, we should try to work with other variables to see if we can increase this as much as possible.


Team batting (H, 2B, 3B, and HR) all have positive impact on wins, we will combine this variables

```{r}
# Add new variable TEAM_BATTING_ALL that sums all the selected batting values
train$TEAM_BATTING_ALL <- rowSums(cbind(train$TEAM_BATTING_H, train$TEAM_BATTING_2B, train$TEAM_BATTING_3B, train$TEAM_BATTING_HR, na.rm = T))

# Build model
lm3 <- 
```




### Buid single linear regression first: build models for each predictor variable and observe patters to see if transformations are recommended.

```{r}

batting2B <- lm(TARGET_WINS ~ TEAM_BATTING_2B, data = train)
summary(batting2B)
plot(train$TEAM_BATTING_2B, train$TARGET_WINS)
plot(batting2B)
```
```{r}
batting3B <- lm(TARGET_WINS ~ TEAM_BATTING_3B, data = train)
summary(batting3B)
plot(train$TEAM_BATTING_3B, train$TARGET_WINS)
plot(batting3B)
```

### Model #1: Identify highest impacting independent variables

